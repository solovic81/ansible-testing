---
# Gather basic system facts
- name: Gather Cumulus system facts
  ansible.builtin.setup:

# Get additional Cumulus-specific info
- name: Get OS version
  ansible.builtin.command: cat /etc/os-release
  register: os_version
  changed_when: false

- name: Get interface summary
  ansible.builtin.command: ip -brief addr
  register: iface_summary
  changed_when: false

- name: Get routing summary
  ansible.builtin.command: ip route show
  register: route_summary
  changed_when: false

# Print everything neatly

- name: Display Cumulus switch facts on screen
  debug:
    msg:
      - "--------------------------------------------------"
      - " Hostname      : {{ ansible_facts['hostname'] }}"
      - " OS            : {{ ansible_facts['lsb']['id']}}-{{ ansible_facts['lsb']['release']}}"
#      - " Architecture : {{ ansible_facts['architecture'] }}"
      - " Management IP : {{ ansible_facts['eth0']['ipv4']['address']}}\/{{ ansible_facts['eth0']['ipv4']['prefix']}}"
#      - " CPU: {{ ansible_facts['processor_count'] }} cores"
#      - " Memory: {{ (ansible_facts['memtotal_mb'] / 1024) | round(2) }} GB"
#      - "--------------------------------------------------"
#      - "üåê Interface Summary:"
#      - "{{ iface_summary.stdout_lines }}"
#      - "--------------------------------------------------"
#      - "üõ£Ô∏è Routing Table Summary:"
#      - "{{ route_summary.stdout_lines }}"
#      - "--------------------------------------------------"
